(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();let u=null,g=[],m=0;const n={};window.addEventListener("message",s=>{var o,c,t,r;const e=s.data;if(!(!e||!e.type))switch(e.type){case"wallet_connected":u=e.address,g.forEach(d=>d(u));break;case"wallet_disconnected":u=null,g.forEach(d=>d(null));break;case"tx_success":(o=n[e.requestId])==null||o.resolve(e.hashes),delete n[e.requestId];break;case"tx_rejected":(c=n[e.requestId])==null||c.reject(new Error(e.error??e.reason??"Rejected")),delete n[e.requestId];break;case"sign_success":(t=n[e.requestId])==null||t.resolve({signature:e.signature,verified:e.verified}),delete n[e.requestId];break;case"sign_rejected":(r=n[e.requestId])==null||r.reject(new Error(e.error??e.reason??"Rejected")),delete n[e.requestId];break}});window.parent!==window&&window.parent.postMessage({type:"request_address"},"*");function p(s){g.push(s),s(u)}function w(s){return new Promise((e,o)=>{const c="req_"+ ++m;n[c]={resolve:e,reject:o},window.parent.postMessage({type:"sign_message",requestId:c,message:s},"*")})}const l=document.getElementById("status"),i=document.getElementById("signBtn"),a=document.getElementById("result"),y=document.getElementById("messageInput");let f=null;p(s=>{f=s,s?(l.className="status connected",l.innerHTML='Connected: <span class="addr">'+s+"</span>",i.disabled=!1):(l.className="status disconnected",l.textContent="Wallet not connected",i.disabled=!0)});i.addEventListener("click",async()=>{const s=y.value.trim();if(!s){a.className="result error show",a.textContent="Please enter a message to sign";return}i.disabled=!0,a.className="result pending show",a.textContent="Requesting signature approval from host app...";try{const{signature:e,verified:o}=await w(s);a.className="result success show",a.innerHTML=`
      Message signed successfully!
      <div class="sig-details">
        <strong>Verified:</strong>
        <code>${o?"Yes":"No"}</code>
        <strong>Signature:</strong>
        <code>${e}</code>
        <strong>Signer:</strong>
        <code>${f}</code>
      </div>
    `}catch(e){a.className="result error show",a.textContent="Failed: "+e.message}i.disabled=!1});
